{"ast":null,"code":"var _jsxFileName = \"/home/gusta/workspace/GitGoBarber/GoBarber-Web/src/pages/Dashboard/index.tsx\";\nimport React, { useState, useCallback, useEffect, useMemo } from 'react';\nimport { isToday, format, parseISO } from 'date-fns';\nimport ptBR from 'date-fns/locale/pt-BR';\nimport { FiPower, FiClock } from 'react-icons/fi';\nimport DayPicker from 'react-day-picker';\nimport 'react-day-picker/lib/style.css';\nimport { Container, Header, HeaderContent, Profile, Content, Schedule, Calendar, NextAppointment, Section, Appointment } from './styles';\nimport logoImg from \"../../assets/logo.svg\";\nimport { useAuth } from '../../hooks/auth';\nimport api from '../../services/api';\n\nconst Dashboard = () => {\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [currentMonth, setCurrentMonth] = useState(new Date());\n  const [appointments, setAppointments] = useState([]);\n  const [monthAvailability, setMonthAvailability] = useState([]);\n  const {\n    signOut,\n    user\n  } = useAuth();\n  const handleDateChange = useCallback((day, modifiers) => {\n    if (modifiers.available && !modifiers.disabled) {\n      setSelectedDate(day);\n    }\n  }, []);\n  const handleMonthChange = useCallback(month => {\n    setCurrentMonth(month);\n  }, []);\n  useEffect(() => {\n    api.get(`/providers/${user.id}/month-availability`, {\n      params: {\n        year: currentMonth.getFullYear(),\n        month: currentMonth.getMonth() + 1\n      }\n    }).then(response => {\n      setMonthAvailability(response.data);\n    });\n  }, [currentMonth, user.id]);\n  useEffect(() => {\n    api.get('/appointments/me', {\n      params: {\n        year: selectedDate.getFullYear(),\n        month: selectedDate.getMonth() + 1,\n        day: selectedDate.getDate()\n      }\n    }).then(response => {\n      const appointmentsFormatted = response.data.map(appointment => {\n        return { ...appointment,\n          hourFormatted: format(parseISO(appointment.date), 'HH:mm')\n        };\n      });\n      setAppointments(appointmentsFormatted);\n    });\n  }, [selectedDate]);\n  const disabledDays = useMemo(() => {\n    const dates = monthAvailability.filter(monthDay => monthDay.available === false).map(monthDay => {\n      const year = currentMonth.getFullYear();\n      const month = currentMonth.getMonth();\n      return new Date(year, month, monthDay.day);\n    });\n    return dates;\n  }, [currentMonth, monthAvailability]);\n  const selectedDateAsText = useMemo(() => {\n    return format(selectedDate, \"'Dia' dd 'de' MMM, \", {\n      locale: ptBR\n    });\n  }, [selectedDate]);\n  const selectedWeekDay = useMemo(() => {\n    return format(selectedDate, 'cccc', {\n      locale: ptBR\n    });\n  }, [selectedDate]);\n  useEffect(() => {\n    api.get('/appointments/me', {\n      params: {\n        year: selectedDate.getFullYear(),\n        month: selectedDate.getMonth() + 1,\n        day: selectedDate.getDate()\n      }\n    }).then(response => {\n      const appointmentsFormatted = response.data.map(appointment => {\n        return { ...appointment,\n          hourFormatted: format(parseISO(appointment.date), 'HH:mm')\n        };\n      });\n      setAppointments(appointmentsFormatted);\n    });\n  }, [selectedDate]);\n  const morningAppointments = useMemo(() => {\n    return appointments.filter(appointment => {\n      return parseISO(appointment.date).getHours() < 12;\n    });\n  }, [appointments]);\n  const afternoonAppointments = useMemo(() => {\n    return appointments.filter(appointment => {\n      return parseISO(appointment.date).getHours() >= 12;\n    });\n  }, [appointments]);\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(HeaderContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: logoImg,\n    alt: \"GoBarber\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Profile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: user.avatar_url,\n    alt: user.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 15\n    }\n  }, \" Bem Vindo,\"), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 15\n    }\n  }, \" \", user.name))), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: signOut,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(FiPower, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  })))), /*#__PURE__*/React.createElement(Content, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Schedule, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 11\n    }\n  }, \"Hor\\xE1rios Agendados\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 11\n    }\n  }, isToday(selectedDate) && /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 39\n    }\n  }, \"Hoje\"), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 13\n    }\n  }, \" \", selectedDateAsText), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }, \" \", selectedWeekDay, \" \")), /*#__PURE__*/React.createElement(NextAppointment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }\n  }, \" Atendimento a seguir\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"https://veja.abril.com.br/wp-content/uploads/2019/01/Jordan-Peterson.jpg\",\n    alt: \"Barbeiro Peterson\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 15\n    }\n  }, \"Charles Barber\"), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(FiClock, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 17\n    }\n  })))), /*#__PURE__*/React.createElement(Section, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 13\n    }\n  }, \" Manh\\xE3\"), morningAppointments.map(appointment => /*#__PURE__*/React.createElement(Appointment, {\n    key: appointment.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FiClock, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 19\n    }\n  }), appointment.hourFormatted), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: appointment.user.avatar_url,\n    alt: appointment.user.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 19\n    }\n  }, appointment.user.name))))), /*#__PURE__*/React.createElement(Section, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 13\n    }\n  }, \" Tarde\"), afternoonAppointments.map(appointment => /*#__PURE__*/React.createElement(Appointment, {\n    key: appointment.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FiClock, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 19\n    }\n  }), appointment.hourFormatted), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: appointment.user.avatar_url,\n    alt: appointment.user.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 19\n    }\n  }, appointment.user.name)))))), /*#__PURE__*/React.createElement(Calendar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DayPicker, {\n    weekdaysShort: ['D', 'S', 'T', 'Q', 'Q', 'S', 'S'],\n    fromMonth: new Date(),\n    disabledDays: [{\n      daysOfWeek: [0, 6]\n    }, ...disableDays],\n    modifiers: {\n      available: {\n        daysOfWeek: [1, 2, 3, 4, 5]\n      }\n    },\n    onMonthChange: handleMonthChance,\n    selectedDays: selectedDate,\n    onDayClick: handleDateChance,\n    months: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 11\n    }\n  }))));\n};\n\nexport default Dashboard;","map":{"version":3,"sources":["/home/gusta/workspace/GitGoBarber/GoBarber-Web/src/pages/Dashboard/index.tsx"],"names":["React","useState","useCallback","useEffect","useMemo","isToday","format","parseISO","ptBR","FiPower","FiClock","DayPicker","Container","Header","HeaderContent","Profile","Content","Schedule","Calendar","NextAppointment","Section","Appointment","useAuth","api","Dashboard","selectedDate","setSelectedDate","Date","currentMonth","setCurrentMonth","appointments","setAppointments","monthAvailability","setMonthAvailability","signOut","user","handleDateChange","day","modifiers","available","disabled","handleMonthChange","month","get","id","params","year","getFullYear","getMonth","then","response","data","getDate","appointmentsFormatted","map","appointment","hourFormatted","date","disabledDays","dates","filter","monthDay","selectedDateAsText","locale","selectedWeekDay","morningAppointments","getHours","afternoonAppointments","logoImg","avatar_url","name","daysOfWeek","disableDays","handleMonthChance","handleDateChance"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect, useMemo } from 'react';\nimport { isToday, format, parseISO } from 'date-fns';\nimport ptBR from 'date-fns/locale/pt-BR';\nimport { FiPower, FiClock } from 'react-icons/fi';\nimport DayPicker, { DayModifiers } from 'react-day-picker';\nimport 'react-day-picker/lib/style.css';\n\nimport {\n  Container,\n  Header,\n  HeaderContent,\n  Profile,\n  Content,\n  Schedule,\n  Calendar,\n  NextAppointment,\n  Section,\n  Appointment,\n} from './styles';\n\nimport logoImg from '../../assets/logo.svg';\nimport { useAuth } from '../../hooks/auth';\nimport api from '../../services/api';\n\ninterface MonthAvailabilityItem {\n  day: number;\n  available: boolean;\n}\n\ninterface Appointment {\n  id: string;\n  date: string;\n  hourFormatted: string;\n  user: {\n    name: string;\n    avatar_url: string;\n  };\n}\n\nconst Dashboard: React.FC = () => {\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [currentMonth, setCurrentMonth] = useState(new Date());\n\n  const [appointments, setAppointments] = useState<Apppointment[]>([]);\n\n  const [monthAvailability, setMonthAvailability] = useState<\n    MonthAvailabilityItem[]\n  >([]);\n\n  const { signOut, user } = useAuth();\n\n  const handleDateChange = useCallback((day: Date, modifiers: DayModifiers) => {\n    if (modifiers.available && !modifiers.disabled) {\n      setSelectedDate(day);\n    }\n  }, []);\n\n  const handleMonthChange = useCallback((month: Date) => {\n    setCurrentMonth(month);\n  }, []);\n\n  useEffect(() => {\n    api\n      .get(`/providers/${user.id}/month-availability`, {\n        params: {\n          year: currentMonth.getFullYear(),\n          month: currentMonth.getMonth() + 1,\n        },\n      })\n      .then((response) => {\n        setMonthAvailability(response.data);\n      });\n  }, [currentMonth, user.id]);\n\n  useEffect(() => {\n    api\n      .get<Apppointment[]>('/appointments/me', {\n        params: {\n          year: selectedDate.getFullYear(),\n          month: selectedDate.getMonth() + 1,\n          day: selectedDate.getDate(),\n        },\n      })\n      .then((response) => {\n        const appointmentsFormatted = response.data.map((appointment) => {\n          return {\n            ...appointment,\n            hourFormatted: format(parseISO(appointment.date), 'HH:mm'),\n          };\n        });\n\n        setAppointments(appointmentsFormatted);\n      });\n  }, [selectedDate]);\n\n  const disabledDays = useMemo(() => {\n    const dates = monthAvailability\n      .filter((monthDay) => monthDay.available === false)\n      .map((monthDay) => {\n        const year = currentMonth.getFullYear();\n        const month = currentMonth.getMonth();\n\n        return new Date(year, month, monthDay.day);\n      });\n\n    return dates;\n  }, [currentMonth, monthAvailability]);\n  const selectedDateAsText = useMemo(() => {\n    return format(selectedDate, \"'Dia' dd 'de' MMM, \", {\n      locale: ptBR,\n    });\n  }, [selectedDate]);\n\n  const selectedWeekDay = useMemo(() => {\n    return format(selectedDate, 'cccc', {\n      locale: ptBR,\n    });\n  }, [selectedDate]);\n\n  useEffect(() => {\n    api\n      .get<Appointment[]>('/appointments/me', {\n        params: {\n          year: selectedDate.getFullYear(),\n          month: selectedDate.getMonth() + 1,\n          day: selectedDate.getDate(),\n        },\n      })\n      .then((response) => {\n        const appointmentsFormatted = response.data.map((appointment) => {\n          return {\n            ...appointment,\n            hourFormatted: format(parseISO(appointment.date), 'HH:mm'),\n          };\n        });\n\n        setAppointments(appointmentsFormatted);\n      });\n  }, [selectedDate]);\n\n  const morningAppointments = useMemo(() => {\n    return appointments.filter((appointment) => {\n      return parseISO(appointment.date).getHours() < 12;\n    });\n  }, [appointments]);\n\n  const afternoonAppointments = useMemo(() => {\n    return appointments.filter((appointment) => {\n      return parseISO(appointment.date).getHours() >= 12;\n    });\n  }, [appointments]);\n\n  return (\n    <Container>\n      <Header>\n        <HeaderContent>\n          <img src={logoImg} alt=\"GoBarber\" />\n\n          <Profile>\n            <img src={user.avatar_url} alt={user.name} />\n\n            <div>\n              <span> Bem Vindo,</span>\n              <strong> {user.name}</strong>\n            </div>\n          </Profile>\n\n          <button type=\"button\" onClick={signOut}>\n            <FiPower />\n          </button>\n        </HeaderContent>\n      </Header>\n\n      <Content>\n        <Schedule>\n          <h1>Horários Agendados</h1>\n          <p>\n            {isToday(selectedDate) && <span>Hoje</span>}\n            <span> {selectedDateAsText}</span>\n            <span> {selectedWeekDay} </span>\n          </p>\n\n          <NextAppointment>\n            <strong> Atendimento a seguir</strong>\n            <div>\n              <img\n                src=\"https://veja.abril.com.br/wp-content/uploads/2019/01/Jordan-Peterson.jpg\"\n                alt=\"Barbeiro Peterson\"\n              />\n\n              <strong>Charles Barber</strong>\n              <span>\n                <FiClock />\n              </span>\n            </div>\n          </NextAppointment>\n          <Section>\n            <strong> Manhã</strong>\n\n            {morningAppointments.map((appointment) => (\n              <Appointment key={appointment.id}>\n                <span>\n                  <FiClock />\n                  {appointment.hourFormatted}\n                </span>\n\n                <div>\n                  <img\n                    src={appointment.user.avatar_url}\n                    alt={appointment.user.name}\n                  />\n                  <strong>{appointment.user.name}</strong>\n                </div>\n              </Appointment>\n            ))}\n          </Section>\n\n          <Section>\n            <strong> Tarde</strong>\n            {afternoonAppointments.map((appointment) => (\n              <Appointment key={appointment.id}>\n                <span>\n                  <FiClock />\n                  {appointment.hourFormatted}\n                </span>\n\n                <div>\n                  <img\n                    src={appointment.user.avatar_url}\n                    alt={appointment.user.name}\n                  />\n                  <strong>{appointment.user.name}</strong>\n                </div>\n              </Appointment>\n            ))}\n          </Section>\n        </Schedule>\n        <Calendar>\n          <DayPicker\n            weekdaysShort={['D', 'S', 'T', 'Q', 'Q', 'S', 'S']}\n            fromMonth={new Date()}\n            disabledDays={[{ daysOfWeek: [0, 6] }, ...disableDays]}\n            modifiers={{\n              available: { daysOfWeek: [1, 2, 3, 4, 5] },\n            }}\n            onMonthChange={handleMonthChance}\n            selectedDays={selectedDate}\n            onDayClick={handleDateChance}\n            months={[\n              'Janeiro',\n              'Fevereiro',\n              'Março',\n              'Abril',\n              'Maio',\n              'Junho',\n              'Julho',\n              'Agosto',\n              'Setembro',\n              'Outubro',\n              'Novembro',\n              'Dezembro',\n            ]}\n          />\n        </Calendar>\n      </Content>\n    </Container>\n  );\n};\n\nexport default Dashboard;\n"]},"metadata":{},"sourceType":"module"}